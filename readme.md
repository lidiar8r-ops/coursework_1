<<<<<<< develop
# Проект 1. Приложение для анализа банковских операций
    
приложение для анализа транзакций, которые находятся в Excel-файле. Приложение будет генерировать JSON-данные 
для веб-страниц, формировать Excel-отчеты, а также предоставлять другие сервисы.


## Cтатус разработки: 

в разработке


## Установка:

1 Клонируйте репозиторий:
``` git clone git@github.com:lidiar8r-ops/coursework_1.git  ```

2 Перейдите в папку проекта:
``` cd ваш_репозиторий```

3 Установите зависимости:
``` pip install -r requirements.txt```


## Зависимости
• Python 3.x

• Все библиотеки, которые использованы в проекте указаны в **requirements.txt**
 

## Тестирование
Код покрыт тестами Coverage report: 92%

HTML-отчёт, который показывает, какие строки кода были покрыты тестами, а какие нет в 
[(htmlcov/index.html)](https://github.com/lidiar8r-ops/coursework_1/blob/coursework_1/htmlcov/index.html)

Для запуска тестов воспользуйтесь командой  ```poetry```


## Реализовано


* ### «Главный модуль»
    запустив который, можно получить результат всех реализованных в проекте функциональностей.
<details> 
  <summary> Функции, вызываемые в этом разделе (Нажмите, чтобы раскрыть)</summary>
  
Модуль **main**:

```python
    # Вызов функции считывание данных из файла и фильтруем по статусу операции <<OK>>
    get_list_operation
    # Вызов функции события events_operations
    events_operations(df, "20.05.2020", "Y")
    # Вызов функции анализа повышенного кэшбэка get_profitable_cashback
    get_profitable_cashback(df, "2019", "10")
    # вызов функции Трат по дням недели
    spending_by_weekday(df,"01.01.2022")
    # Вывод в консоль результаты этих функций
```
</details> 



* ### Страница «События»

Реализован набор функций и главная функция, которая принимает на вход строку с датой и второй необязательный параметр — 
диапазон данных. По умолчанию диапазон равен одному месяцу (с начала месяца, на который выпадает дата, по саму дату).

Возможные значения диапазона:

    W — неделя, на которую приходится дата;
    M — месяц, на который приходится дата;
    Y — год, на который приходится дата;
    ALL — все данные до указанной даты.

 
<details> 
  <summary> Функции, реализованные в этом разделе (Нажмите, чтобы раскрыть)</summary>
  
1. Модуль **views**:

```python
def events_operations(df: DataFrame, str_date: str, range_data: str = "M") -> dict:
    """Реализует набор функций и главную функцию, принимающую на вход строку с датой и второй необязательный параметр  — диапазон данных.
    @param str_date: дата в строковом виде
    @param range_data: необязательный параметр — диапазон данных.

        По умолчанию диапазон равен одному месяцу (с начала месяца, на который выпадает дата, по саму дату)
        Возможные значения второго необязательного параметра:
        W - неделя, на которую приходится дата;
        M - месяц, на который приходится дата;
        Y - год, на который приходится дата;
        ALL - все данные до указанной даты.

    @param range_data:

    return: JSON-ответ, который содержит следующие данные:

        «Расходы»:
            Общая сумма расходов.
            Раздел «Основные», в котором траты по категориям отсортированы по убыванию. Данные предоставляются по 7
            категориям с наибольшими тратами, траты по остальным категориям суммируются и попадают в категорию
            «Остальное».
            Раздел «Переводы и наличные», в котором сумма по категориям «Наличные» и «Переводы» отсортирована
            по убыванию.

        «Поступления»:
            Общая сумма поступлений.
            Раздел «Основные», в котором поступления по категориям отсортированы по убыванию.

        Курс валют.

        Стоимость акций из S&P 500.
    """
``` 

2. Модуль **utils**:

```python
def get_list_operation(
    path_filename: str, list_operation: list, filter_str: str = "OK", name_field: str = "Статус"
) -> DataFrame:
    """
    Функция читает файл CSV или Excel, и передает полученный FataFrame
    :param path_filename: путь к файлу CSV или XLX, XLSX
    :param list_operation: список обязательных полей
    :param filter_str: статус операции, по умолчанию "OK"
    :param name_field: имя колонки, по умолчанию "Статус"
    :return: DataFrame словарь с данными
    """
```

```python    
def get_period_operation(str_date: str, range_data: str = "M") -> list:
    """
    Получает период и возвращает список даты с и по.
    :param str_date: дата в строковом виде (например, "19.05.2025")
    :param range_data: диапазон данных:
        "W" — неделя, на которую приходится дата;
        "M" — месяц, на который приходится дата (по умолчанию);
        "Y" — год, на который приходится дата;
        "ALL" — все данные до указанной даты.
    :return: список словарей (записи DataFrame)
    """
```

```python
def filter_by_date(df: pd.DataFrame, list_period: List) -> DataFrame:
    """
    Фильтрует данные по периоду и возвращает список словарей.

    :param df: DataFrame с колонкой "Дата платежа" в формате ДД.ММ.ГГГГ
    :param list_period: список с периодами дат
    :return: список словарей (записи DataFrame)
    #"""
```

```python
def get_exchange_rate(carrency_code: str, target_currency: str = "RUB") -> float:
    """
    Для получения текущего курса валют
    принимает на вход название валюты, если валюта была не RUB, происходит обращение к внешнему API для получения
    текущего курса валют в рублях.
    :param carrency_code: из какой валюты
    :param target_currency: в какую валюту
    :return: сумму в рублях по курсу, тип данных —float.
    """
```

```python
def conversion_to_single_currency(df: pd.DataFrame, target_currency: str = "RUB") -> pd.DataFrame:
    """
    Преобразует суммы платежей в единую валюту (по умолчанию — RUB).
    :param df: DataFrame с транзакциями. Должен содержать столбцы:
        - LIST_OPERATION[2] — код валюты (например, 'USD', 'EUR')
        - LIST_OPERATION[3] — сумма платежа (числовой тип)
    :param target_currency: целевая валюта для конвертации (по умолчанию 'RUB')
    :return: DataFrame с пересчитанными суммами в целевой валюте
"""
```

```python
def get_data_from_expensess(df: pd.DataFrame) -> Dict:
    """
    Формирование раздела «Расходы»: суммирует отрицательные значения в колонке суммы (в RUB).
    :param df: DataFrame с колонкой суммы в RUB (например, 'Сумма_RUB')
    :return: список словарей с итоговыми расходами
    """
```

```python
def get_data_from_income(df: pd.DataFrame) -> Dict:
    """
    Формирование раздела «Поступления»: суммирует положительные значения в колонке суммы (в RUB).

    :param df: DataFrame с колонкой суммы в RUB (например, 'Сумма_RUB')
    :return: список словарей с итоговыми поступлениями
    """
```

```python
def get_user_settings(file_path: str) -> Dict:
    """ функция берет из файла с настройками пользователей данные и преобразует их в словарь
    :param file_path: путь к файлу с настройками данных пользователя
    :return: словарь с настройками
    """
```

```python
def get_currency_rates(dict_user: Dict) -> List[Dict]:
    """
    Функция получает курсы валют.

    :param dict_user: словарь с настройками пользователя, должен содержать:
        - "user_currencies": список валют (например, ["USD", "EUR"])
    :return: список словарей с полями 'currency' и 'rate'
    """
```

```python
def get_stock_price_sp_500(dict_user: dict) -> List[Dict]:
    """
    Функция получает через API FMP текущие цены указанных акций.
    Возвращает только тикер (stock) и цену (price).

    :param dict_user: словарь с настройками пользователя, должен содержать:
        - "user_stocks": список тикеров акций (например, ["AAPL", "MSFT"])
    :return: список словарей с полями 'stock' и 'price'
    """
```

```python

def write_json(dict_wr: Union[Dict[str, Any], List[Dict[Any, Any]]], name_file: str = "answer.json") -> None:
    """
    Выводит в JSON‑файл все полученные данные по разделам.

    :param dict_wr: словарь с данными для записи. Ключи должны быть строками.
    :return: None
    """
```

3. Модуль **app_logger**:   
позволяет унифицировать вывод в лог-файл и сделать код компактнее

```python
def get_file_handler(name: str) -> logging.FileHandler:
    """
    Создаёт файловый обработчик логов.
    :param name: имя файла лога (без пути)
    :return: экземпляр FileHandler
    """
```

```python
def get_stream_handler() -> logging.StreamHandler:
    """
    Создаёт обработчик вывода в консоль (только ошибки).

    :return: экземпляр StreamHandler
    """ 
```

```python
def get_logger(name: str) -> Logger:
    """
    Создаёт логгер с файловым и консольным обработчиками.

    :param name: имя логгера (обычно __name__ модуля)
    :return: настроеннный экземпляр Logger
    """
```
4. Модуль **config**:   

хранит настройки программы:
пути к файлам и логам, имя, загружаемого файла с необходимыми полями  и url-ссылки для API сервисов 

</details>

В результате выполнения программы будет JSON-ответ, который содержит следующие данные:

- «Расходы»:

Общая сумма расходов.
Раздел «Основные», в котором траты по категориям отсортированы по убыванию. Данные предоставляются по 7 категориям с наибольшими тратами, траты по остальным категориям суммируются и попадают в категорию «Остальное».
Раздел «Переводы и наличные», в котором сумма по категориям «Наличные» и «Переводы» отсортирована по убыванию.

- «Поступления»:    

Общая сумма поступлений.
Раздел «Основные», в котором поступления по категориям отсортированы по убыванию.

- «Курс валют».

- «Стоимость акций из S&P 500».

    Цифры по тратам и поступлениям округлены до целых.
Пример JSON-строки с ответом

 ```python  
    {
      "expenses": {
        "total_amount": 32101,
        "main": [
          {
            "category": "Супермаркеты",
            "amount": 17319
          },
          {
            "category": "Фастфуд",
            "amount": 3324
      },
          {
            "category": "Топливо",
            "amount": 2289
          },
          {
            "category": "Развлечения",
            "amount": 1850
          },
          {
            "category": "Медицина",
            "amount": 1350
          },
          {
            "category": "Остальное",
            "amount": 2954
          }
        ],        
      "income": {
        "total_amount": 54271,
        "main": [
          {
            "category": "Пополнение_BANK007",
            "amount": 33000
          },
          {
            "category": "Проценты_на_остаток",
            "amount": 1242
          },
          {
            "category": "Кэшбэк",
            "amount": 29
          }
        ]
      },
      "currency_rates": [
        {
          "currency": "USD",
          "rate": 73.21
        },
        {
          "currency": "EUR",
          "rate": 87.08
        }
      ],
      "stock_prices": [
        {
          "stock": "AAPL",
          "price": 150.12
        },
        {
          "stock": "AMZN",
          "price": 3173.18
        },
        {
          "stock": "GOOGL",
          "price": 2742.39
        },
        {
          "stock": "MSFT",
          "price": 296.71
        },
        {
          "stock": "TSLA",
          "price": 1007.08
        }
      ]
    }
 ```     

* ### «Сервисы»

**Выгодные категории повышенного кешбэка**

Сервис позволяет проанализировать, какие категории были наиболее выгодными для выбора в качестве категорий повышенного кешбэка.
На вход функции поступают данные для анализа, год и месяц.
Входные параметры:

    data — данные с транзакциями;

    year — год, за который проводится анализ;

    month — месяц, за который проводится анализ.

На выходе — JSON с анализом, сколько на каждой категории можно заработать кешбэка в указанном месяце года.

пример выходных данных:
    
```json
    {
        "Категория 1": 1000,
        "Категория 2": 2000,
        "Категория 3": 500
    }
```

<details> 
  <summary> Функции, реализованные в этом разделе (Нажмите, чтобы раскрыть)</summary>
 
Модуль **services**:

```python
def get_profitable_cashback(data: DataFrame, str_year: str, str_month: str) -> Dict[str, float]:
    """
    Анализирует, какие категории были наиболее выгодными для выбора
    в качестве категорий повышенного кэшбэка.

    :param data: DataFrame с транзакциями. Должен содержать столбцы:
        - "Дата платежа" (datetime или преобразуемый в datetime)
        - "Кэшбэк" (числовой, >= 0)
        - LIST_OPERATION[4] (название категории, str)
    :param str_year: год для анализа (строка, например "2025")
    :param str_month: месяц для анализа (строка, например "11")
    :return: словарь {категория: сумма кэшбэка}, отсортированный по убыванию.
             Пустой dict, если данных нет.
    """
```
</details>


* ### «Отчеты»

**Траты по дням недели**

Функция принимает на вход:

    датафрейм с транзакциями,
    опциональную дату.

Если дата не передана, то берется текущая дата.

В результате выполнения aункция возвращает средние траты в каждый из дней недели за последние три месяца (от переданной даты).

<details> 
  <summary> Функции, реализованные в этом разделе (Нажмите, чтобы раскрыть)</summary>
 
Модуль **reports**:

```python
def decorator_write_with_args(file_name: str = "reports.json") -> Callable:
    """
    Декоратор для функций-отчетов, который записывает в файл результат, который возвращает функция, формирующая отчет.
    :param file_name: Декоратор без параметра — записывает данные отчета в файл с названием по умолчанию.
                     Декоратор с параметром — принимает имя файла в качестве параметра.
    :return: Записывает результат функции в файл file_name.
    """

```

```python
def spending_by_weekday(transactions: pd.DataFrame, date: Optional[str] = None) -> pd.DataFrame:
    """
    Возвращает средние траты в каждый из дней недели за последние три месяца (от переданной даты).

    :param transactions: DataFrame с транзакциями. Должен содержать:
        - столбец с датой (предполагается "Дата платежа")
        - столбец с суммой (new_amount_col, например "Сумма")
    :param date: строка в формате "дд.мм.гггг" (опционально). Если не указана — берётся текущая дата.
    :return: DataFrame с колонками: "день_недели", "средние_траты"
    """
```

</details>


## Цель разработки: 

применение знаний в написание кода на Python  

## Автор
[@lidiar8r-ops](https://github.com/lidiar8r-ops)
=======
# Проект 1. Приложение для анализа банковских операций
    
приложение для анализа транзакций, которые находятся в Excel-файле. Приложение будет генерировать JSON-данные 
для веб-страниц, формировать Excel-отчеты, а также предоставлять другие сервисы.


## Cтатус разработки: 

в разработке


## Установка:

1 Клонируйте репозиторий:
``` git clone git@github.com:lidiar8r-ops/homework.git  ```

2 Перейдите в папку проекта:
``` cd ваш_репозиторий```

3 Установите зависимости:
``` pip install -r requirements.txt```


## Зависимости
• Python 3.x

• Все библиотеки, которые использованы в проекте указаны в **requirements.txt**
 

## Тестирование
Код покрыт тестами Coverage report: 92%

HTML-отчёт, который показывает, какие строки кода были покрыты тестами, а какие нет в 
[(htmlcov/index.html)](https://github.com/lidiar8r-ops/coursework_1/blob/coursework_1/htmlcov/index.html)

Для запуска тестов воспользуйтесь командой  ```poetry```


## Реализовано


* ### «Главный модуль»
    запустив который, можно получить результат всех реализованных в проекте функциональностей.
<details> 
  <summary> Функции, вызываемые в этом разделе (Нажмите, чтобы раскрыть)</summary>
  
Модуль **main**:

```python
    # Вызов функции считывание данных из файла и фильтруем по статусу операции <<OK>>
    get_list_operation
    # Вызов функции события events_operations
    events_operations(df, "20.05.2020", "Y")
    # Вызов функции анализа повышенного кэшбэка get_profitable_cashback
    get_profitable_cashback(df, "2019", "10")
    # вызов функции Трат по дням недели
    spending_by_weekday(df,"01.01.2022")
    # Вывод в консоль результаты этих функций
```
</details> 



* ### Страница «События»

Реализован набор функций и главная функция, которая принимает на вход строку с датой и второй необязательный параметр — 
диапазон данных. По умолчанию диапазон равен одному месяцу (с начала месяца, на который выпадает дата, по саму дату).

Возможные значения диапазона:

    W — неделя, на которую приходится дата;
    M — месяц, на который приходится дата;
    Y — год, на который приходится дата;
    ALL — все данные до указанной даты.

 
<details> 
  <summary> Функции, реализованные в этом разделе (Нажмите, чтобы раскрыть)</summary>
  
1. Модуль **views**:

```python
def events_operations(df: DataFrame, str_date: str, range_data: str = "M") -> dict:
    """Реализует набор функций и главную функцию, принимающую на вход строку с датой и второй необязательный параметр  — диапазон данных.
    @param str_date: дата в строковом виде
    @param range_data: необязательный параметр — диапазон данных.

        По умолчанию диапазон равен одному месяцу (с начала месяца, на который выпадает дата, по саму дату)
        Возможные значения второго необязательного параметра:
        W - неделя, на которую приходится дата;
        M - месяц, на который приходится дата;
        Y - год, на который приходится дата;
        ALL - все данные до указанной даты.

    @param range_data:

    return: JSON-ответ, который содержит следующие данные:

        «Расходы»:
            Общая сумма расходов.
            Раздел «Основные», в котором траты по категориям отсортированы по убыванию. Данные предоставляются по 7
            категориям с наибольшими тратами, траты по остальным категориям суммируются и попадают в категорию
            «Остальное».
            Раздел «Переводы и наличные», в котором сумма по категориям «Наличные» и «Переводы» отсортирована
            по убыванию.

        «Поступления»:
            Общая сумма поступлений.
            Раздел «Основные», в котором поступления по категориям отсортированы по убыванию.

        Курс валют.

        Стоимость акций из S&P 500.
    """
``` 

2. Модуль **utils**:

```python
def get_list_operation(
    path_filename: str, list_operation: list, filter_str: str = "OK", name_field: str = "Статус"
) -> DataFrame:
    """
    Функция читает файл CSV или Excel, и передает полученный FataFrame
    :param path_filename: путь к файлу CSV или XLX, XLSX
    :param list_operation: список обязательных полей
    :param filter_str: статус операции, по умолчанию "OK"
    :param name_field: имя колонки, по умолчанию "Статус"
    :return: DataFrame словарь с данными
    """
```

```python    
def get_period_operation(str_date: str, range_data: str = "M") -> list:
    """
    Получает период и возвращает список даты с и по.
    :param str_date: дата в строковом виде (например, "19.05.2025")
    :param range_data: диапазон данных:
        "W" — неделя, на которую приходится дата;
        "M" — месяц, на который приходится дата (по умолчанию);
        "Y" — год, на который приходится дата;
        "ALL" — все данные до указанной даты.
    :return: список словарей (записи DataFrame)
    """
```

```python
def filter_by_date(df: pd.DataFrame, list_period: List) -> DataFrame:
    """
    Фильтрует данные по периоду и возвращает список словарей.

    :param df: DataFrame с колонкой "Дата платежа" в формате ДД.ММ.ГГГГ
    :param list_period: список с периодами дат
    :return: список словарей (записи DataFrame)
    #"""
```

```python
def get_exchange_rate(carrency_code: str, target_currency: str = "RUB") -> float:
    """
    Для получения текущего курса валют
    принимает на вход название валюты, если валюта была не RUB, происходит обращение к внешнему API для получения
    текущего курса валют в рублях.
    :param carrency_code: из какой валюты
    :param target_currency: в какую валюту
    :return: сумму в рублях по курсу, тип данных —float.
    """
```

```python
def conversion_to_single_currency(df: pd.DataFrame, target_currency: str = "RUB") -> pd.DataFrame:
    """
    Преобразует суммы платежей в единую валюту (по умолчанию — RUB).
    :param df: DataFrame с транзакциями. Должен содержать столбцы:
        - LIST_OPERATION[2] — код валюты (например, 'USD', 'EUR')
        - LIST_OPERATION[3] — сумма платежа (числовой тип)
    :param target_currency: целевая валюта для конвертации (по умолчанию 'RUB')
    :return: DataFrame с пересчитанными суммами в целевой валюте
"""
```

```python
def get_data_from_expensess(df: pd.DataFrame) -> Dict:
    """
    Формирование раздела «Расходы»: суммирует отрицательные значения в колонке суммы (в RUB).
    :param df: DataFrame с колонкой суммы в RUB (например, 'Сумма_RUB')
    :return: список словарей с итоговыми расходами
    """
```

```python
def get_data_from_income(df: pd.DataFrame) -> Dict:
    """
    Формирование раздела «Поступления»: суммирует положительные значения в колонке суммы (в RUB).

    :param df: DataFrame с колонкой суммы в RUB (например, 'Сумма_RUB')
    :return: список словарей с итоговыми поступлениями
    """
```

```python
def get_user_settings(file_path: str) -> Dict:
    """ функция берет из файла с настройками пользователей данные и преобразует их в словарь
    :param file_path: путь к файлу с настройками данных пользователя
    :return: словарь с настройками
    """
```

```python
def get_currency_rates(dict_user: Dict) -> List[Dict]:
    """
    Функция получает курсы валют.

    :param dict_user: словарь с настройками пользователя, должен содержать:
        - "user_currencies": список валют (например, ["USD", "EUR"])
    :return: список словарей с полями 'currency' и 'rate'
    """
```

```python
def get_stock_price_sp_500(dict_user: dict) -> List[Dict]:
    """
    Функция получает через API FMP текущие цены указанных акций.
    Возвращает только тикер (stock) и цену (price).

    :param dict_user: словарь с настройками пользователя, должен содержать:
        - "user_stocks": список тикеров акций (например, ["AAPL", "MSFT"])
    :return: список словарей с полями 'stock' и 'price'
    """
```

```python

def write_json(dict_wr: Union[Dict[str, Any], List[Dict[Any, Any]]], name_file: str = "answer.json") -> None:
    """
    Выводит в JSON‑файл все полученные данные по разделам.

    :param dict_wr: словарь с данными для записи. Ключи должны быть строками.
    :return: None
    """
```

3. Модуль **app_logger**:   
позволяет унифицировать вывод в лог-файл и сделать код компактнее

```python
def get_file_handler(name: str) -> logging.FileHandler:
    """
    Создаёт файловый обработчик логов.
    :param name: имя файла лога (без пути)
    :return: экземпляр FileHandler
    """
```

```python
def get_stream_handler() -> logging.StreamHandler:
    """
    Создаёт обработчик вывода в консоль (только ошибки).

    :return: экземпляр StreamHandler
    """ 
```

```python
def get_logger(name: str) -> Logger:
    """
    Создаёт логгер с файловым и консольным обработчиками.

    :param name: имя логгера (обычно __name__ модуля)
    :return: настроеннный экземпляр Logger
    """
```
4. Модуль **config**:   

хранит настройки программы:
пути к файлам и логам, имя, загружаемого файла с необходимыми полями  и url-ссылки для API сервисов 

</details>

В результате выполнения программы будет JSON-ответ, который содержит следующие данные:

- «Расходы»:

Общая сумма расходов.
Раздел «Основные», в котором траты по категориям отсортированы по убыванию. Данные предоставляются по 7 категориям с наибольшими тратами, траты по остальным категориям суммируются и попадают в категорию «Остальное».
Раздел «Переводы и наличные», в котором сумма по категориям «Наличные» и «Переводы» отсортирована по убыванию.

- «Поступления»:    

Общая сумма поступлений.
Раздел «Основные», в котором поступления по категориям отсортированы по убыванию.

- «Курс валют».

- «Стоимость акций из S&P 500».

    Цифры по тратам и поступлениям округлены до целых.
Пример JSON-строки с ответом

 ```python  
    {
      "expenses": {
        "total_amount": 32101,
        "main": [
          {
            "category": "Супермаркеты",
            "amount": 17319
          },
          {
            "category": "Фастфуд",
            "amount": 3324
      },
          {
            "category": "Топливо",
            "amount": 2289
          },
          {
            "category": "Развлечения",
            "amount": 1850
          },
          {
            "category": "Медицина",
            "amount": 1350
          },
          {
            "category": "Остальное",
            "amount": 2954
          }
        ],        
      "income": {
        "total_amount": 54271,
        "main": [
          {
            "category": "Пополнение_BANK007",
            "amount": 33000
          },
          {
            "category": "Проценты_на_остаток",
            "amount": 1242
          },
          {
            "category": "Кэшбэк",
            "amount": 29
          }
        ]
      },
      "currency_rates": [
        {
          "currency": "USD",
          "rate": 73.21
        },
        {
          "currency": "EUR",
          "rate": 87.08
        }
      ],
      "stock_prices": [
        {
          "stock": "AAPL",
          "price": 150.12
        },
        {
          "stock": "AMZN",
          "price": 3173.18
        },
        {
          "stock": "GOOGL",
          "price": 2742.39
        },
        {
          "stock": "MSFT",
          "price": 296.71
        },
        {
          "stock": "TSLA",
          "price": 1007.08
        }
      ]
    }
 ```     

* ### «Сервисы»

**Выгодные категории повышенного кешбэка**

Сервис позволяет проанализировать, какие категории были наиболее выгодными для выбора в качестве категорий повышенного кешбэка.
На вход функции поступают данные для анализа, год и месяц.
Входные параметры:

    data — данные с транзакциями;

    year — год, за который проводится анализ;

    month — месяц, за который проводится анализ.

На выходе — JSON с анализом, сколько на каждой категории можно заработать кешбэка в указанном месяце года.

пример выходных данных:
    
```json
    {
        "Категория 1": 1000,
        "Категория 2": 2000,
        "Категория 3": 500
    }
```

<details> 
  <summary> Функции, реализованные в этом разделе (Нажмите, чтобы раскрыть)</summary>
 
Модуль **services**:

```python
def get_profitable_cashback(data: DataFrame, str_year: str, str_month: str) -> Dict[str, float]:
    """
    Анализирует, какие категории были наиболее выгодными для выбора
    в качестве категорий повышенного кэшбэка.

    :param data: DataFrame с транзакциями. Должен содержать столбцы:
        - "Дата платежа" (datetime или преобразуемый в datetime)
        - "Кэшбэк" (числовой, >= 0)
        - LIST_OPERATION[4] (название категории, str)
    :param str_year: год для анализа (строка, например "2025")
    :param str_month: месяц для анализа (строка, например "11")
    :return: словарь {категория: сумма кэшбэка}, отсортированный по убыванию.
             Пустой dict, если данных нет.
    """
```
</details>


* ### «Отчеты»

**Траты по дням недели**

Функция принимает на вход:

    датафрейм с транзакциями,
    опциональную дату.

Если дата не передана, то берется текущая дата.

В результате выполнения aункция возвращает средние траты в каждый из дней недели за последние три месяца (от переданной даты).

<details> 
  <summary> Функции, реализованные в этом разделе (Нажмите, чтобы раскрыть)</summary>
 
Модуль **reports**:

```python
def decorator_write_with_args(file_name: str = "reports.json") -> Callable:
    """
    Декоратор для функций-отчетов, который записывает в файл результат, который возвращает функция, формирующая отчет.
    :param file_name: Декоратор без параметра — записывает данные отчета в файл с названием по умолчанию.
                     Декоратор с параметром — принимает имя файла в качестве параметра.
    :return: Записывает результат функции в файл file_name.
    """

```

```python
def spending_by_weekday(transactions: pd.DataFrame, date: Optional[str] = None) -> pd.DataFrame:
    """
    Возвращает средние траты в каждый из дней недели за последние три месяца (от переданной даты).

    :param transactions: DataFrame с транзакциями. Должен содержать:
        - столбец с датой (предполагается "Дата платежа")
        - столбец с суммой (new_amount_col, например "Сумма")
    :param date: строка в формате "дд.мм.гггг" (опционально). Если не указана — берётся текущая дата.
    :return: DataFrame с колонками: "день_недели", "средние_траты"
    """
```

</details>


## Цель разработки: 

применение знаний в написание кода на Python  

## Автор
[@lidiar8r-ops](https://github.com/lidiar8r-ops)

>>>>>>> main